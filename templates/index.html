<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>GHOST::ACCESS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        /* same exact colors as dashboard — black + red + green */
        :root {
            --bg: #0b0303;
            --surface: #1a0e0e;
            --card: #221212;
            --primary-red: #ff3b3b;
            --primary-green: #5eff9e;
            --dark-red: #5e1a1a;
            --dark-green: #1b4a2a;
            --text: #e3dcdc;
            --dim: #9e7a7a;
            --border-red: #8b2a2a;
            --border-green: #2f9e5a;
            --glow-red: rgba(255, 50, 50, 0.4);
            --glow-green: rgba(80, 255, 120, 0.5);
        }

        body {
            background: #0a0101;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 16px;
            background-image: radial-gradient(circle at 30% 20%, #2f130f 0%, #020000 100%);
        }

        .login-container {
            width: 100%;
            max-width: 400px;
        }

        .login-card {
            background: #140a0a;
            border: 2px solid #bb4646;
            border-radius: 48px;
            padding: 32px 24px 40px 24px;
            box-shadow: 0 20px 40px -15px #5e0000, inset 0 0 20px #2f0707, 0 0 30px #ff3b3b33;
            background: linear-gradient(160deg, #1d0d0d, #0e0404);
            text-align: center;
            backdrop-filter: blur(2px);
        }

        /* logo besar, memenuhi lebar card, di atas kolom user id */
        .login-logo {
            width: 100%;
            max-width: 280px;  /* proporsional tapi tetap besar */
            margin: 0 auto 20px auto;  /* tengah, jarak bawah ke input */
            filter: drop-shadow(0 0 25px #5eff9e) drop-shadow(0 0 45px #ff3b3b);
            animation: softPulse 2.5s infinite alternate;
            /* optimasi loading: ukuran wajar, preload dengan fetch priority */
            content-visibility: auto;
        }

        .login-logo img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 20px; /* sedikit lembut */
        }

        .login-title {
            color: #ff9f9f;
            font-size: 1.8rem;
            letter-spacing: 6px;
            font-weight: 300;
            text-shadow: 0 0 8px #ff4f4f, 0 0 16px #5eff99;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .login-title i {
            color: #ff5e5e;
            margin-right: 8px;
        }

        /* kolom masukin user id */
        .input-field {
            width: 100%;
            background: #2b1616;
            border: 2px solid #cf5a5a;
            border-radius: 60px;
            padding: 16px 24px;
            color: #ffd9b0;
            font-size: 1.1rem;
            text-align: center;
            outline: none;
            margin-bottom: 24px;
            transition: 0.15s;
            font-family: 'Inter', monospace;
            letter-spacing: 1px;
        }

        .input-field:focus {
            border-color: #5eff99;
            box-shadow: 0 0 20px #5eff99, inset 0 0 10px #2a0a0a;
            background: #331d1d;
        }

        .input-field::placeholder {
            color: #a56767;
            font-size: 0.95rem;
            letter-spacing: 1px;
        }

        .auth-btn {
            background: transparent;
            border: 3px solid #5eff99;
            color: #d4ffd4;
            padding: 16px 20px;
            width: 100%;
            border-radius: 60px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.1s;
            margin-top: 8px;
            -webkit-tap-highlight-color: transparent;
            background: linear-gradient(145deg, #1f3a2a, #0e1e16);
            text-shadow: 0 0 5px #b3ffb3;
        }

        .auth-btn:active {
            transform: scale(0.97);
            background: #5eff99;
            color: black;
            box-shadow: 0 0 50px #ff6262;
        }

        /* pop up loading bar — system style */
        .system-popup {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .popup-card {
            background: #140a0a;
            border: 3px solid #ff5e5e;
            border-radius: 60px;
            padding: 30px 20px;
            max-width: 360px;
            width: 100%;
            text-align: center;
            box-shadow: 0 0 70px #ff4f4f;
        }

        .popup-logo-small {
            width: 80px;
            margin: 0 auto 15px;
            filter: drop-shadow(0 0 15px #5eff99);
        }

        .popup-logo-small img {
            width: 100%;
        }

        .popup-title {
            color: #ffaeae;
            font-size: 1.4rem;
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .popup-bar {
            width: 100%;
            height: 12px;
            background: #2d1212;
            border-radius: 40px;
            border: 1px solid #aa3c3c;
            overflow: hidden;
            margin: 20px 0 12px;
        }

        .popup-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff3a3a, #6aff99, #ff3737);
            box-shadow: 0 0 20px #5eff8c;
            transition: width 0.3s cubic-bezier(0.2, 0.9, 0.3, 1);
        }

        .popup-status {
            color: #9affb5;
            font-family: monospace;
            font-size: 1rem;
            display: flex;
            justify-content: space-between;
            padding: 0 8px;
        }

        .error-message {
            color: #ff7a7a;
            margin-top: 20px;
            font-size: 0.95rem;
            min-height: 24px;
            font-weight: 400;
            text-shadow: 0 0 6px red;
        }

        /* optimasi loading: preload image dengan fetchpriority high */
        .login-logo img {
            fetchpriority: "high";
        }

        @keyframes softPulse {
            0% { filter: drop-shadow(0 0 5px #ff3b3b) drop-shadow(0 0 15px #5eff99); }
            100% { filter: drop-shadow(0 0 35px #ff6565) drop-shadow(0 0 45px #5eff99); }
        }
    </style>
    <!-- preload logo untuk akses lebih cepat -->
    <link rel="preload" as="image" href="https://i.ibb.co.com/mCr6hGfy/Gemini-Generated-Image-xp6maxxp6maxxp6m-1.png" fetchpriority="high">
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <!-- logo besar di atas kolom user id, full width -->
            <div class="login-logo">
                <img src="https://i.ibb.co.com/mCr6hGfy/Gemini-Generated-Image-xp6maxxp6maxxp6m-1.png" 
                     alt="GHOST EMBLEM" 
                     fetchpriority="high"
                     decoding="async">
            </div>
            <div class="login-title">
                <i class="fas fa-skull"></i> User-ID
            </div>
            <input type="text" class="input-field" id="userId" placeholder="ENTER USER ID" autocomplete="off" spellcheck="false" onkeydown="if(event.key==='Enter') attemptLogin()">
            <button class="auth-btn" onclick="attemptLogin()"><i class="fa-regular fa-keyboard"></i> AUTH</button>
            <div id="loginStatus" class="error-message"></div>
        </div>
    </div>

    <!-- POP UP LOADING SYSTEM -->
    <div id="systemPopup" class="system-popup">
        <div class="popup-card">
            <div class="popup-logo-small">
                <img src="https://i.ibb.co.com/mCr6hGfy/Gemini-Generated-Image-xp6maxxp6maxxp6m-1.png" alt="spinner" loading="lazy">
            </div>
            <div class="popup-title">SYSTEM ACCESS</div>
            <div class="popup-bar">
                <div class="popup-fill" id="popupFill" style="width: 0%;"></div>
            </div>
            <div class="popup-status">
                <span id="popupMsg">initializing...</span>
                <span id="popupPercent">0%</span>
            </div>
        </div>
    </div>

    <script>
        // hardcoded users.txt url
        const DB_URL = "https://raw.githubusercontent.com/MRSt3Ss/rat1/refs/heads/main/users.txt";
        const popup = document.getElementById('systemPopup');
        const popupFill = document.getElementById('popupFill');
        const popupMsg = document.getElementById('popupMsg');
        const popupPercent = document.getElementById('popupPercent');
        const loginStatus = document.getElementById('loginStatus');

        // cek localStorage langsung
        if(localStorage.getItem('ghost_uid')) {
            window.location.href = 'dashboard.html';  // redirect ke dashboard
        }

        function simulateLoading(callback) {
            // reset
            popup.style.display = 'flex';
            let progress = 0;
            popupFill.style.width = '0%';
            popupPercent.innerText = '0%';
            popupMsg.innerText = 'handshake ...';

            const interval = setInterval(() => {
                progress += 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    popupFill.style.width = '100%';
                    popupPercent.innerText = '100%';
                    popupMsg.innerText = 'verifying credentials';
                    setTimeout(() => {
                        callback(); // lanjut ke validasi setelah loading kelar
                    }, 200);
                } else {
                    popupFill.style.width = progress + '%';
                    popupPercent.innerText = progress + '%';
                    if (progress < 30) popupMsg.innerText = 'scanning id ...';
                    else if (progress < 70) popupMsg.innerText = 'decrypting payload';
                    else popupMsg.innerText = 'contacting shadow';
                }
            }, 40);
        }

        function attemptLogin() {
            const userId = document.getElementById('userId').value.trim();
            loginStatus.innerText = ''; // bersihkan status

            if (!userId) {
                loginStatus.innerText = '>_ USER ID REQUIRED';
                return;
            }

            // tampilkan loading pop up
            simulateLoading(async () => {
                // setelah loading bar selesai, lakukan fetch
                try {
                    const res = await fetch(DB_URL + "?t=" + Date.now());
                    if (!res.ok) throw new Error(`HTTP ${res.status}`);
                    const text = await res.text();
                    const users = text.split(/\r?\n/).map(u => u.trim()).filter(u => u !== "");

                    console.log("Registered users:", users);

                    if (users.includes(userId)) {
                        popupMsg.innerText = 'ACCESS GRANTED';
                        popupPercent.innerText = '✅';
                        localStorage.setItem('ghost_uid', userId);
                        setTimeout(() => {
                            window.location.href = 'dashboard.html'; // redirect ke dashboard
                        }, 600);
                    } else {
                        // gagal : tutup popup, tampilkan error
                        popup.style.display = 'none';
                        loginStatus.innerText = '⛔ ACCESS DENIED: UNKNOWN ID';
                    }
                } catch (e) {
                    popup.style.display = 'none';
                    loginStatus.innerText = '⚠️ DATABASE ERROR: ' + e.message;
                }
            });
        }

        // global supaya bisa dipanggil dari onclick
        window.attemptLogin = attemptLogin;
    </script>
</body>
</html>
